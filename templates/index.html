<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <link rel="stylesheet" href="/static/css/style.css">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

    <script src="https://unpkg.com/vue@next"></script>

    <!-- <script src="https://unpkg.com/proj4"></script>
    <script src="https://unpkg.com/georaster"></script>
    <script src="https://unpkg.com/georaster-layer-for-leaflet"></script>
    <script src="https://cdn.jsdelivr.net/npm/geotiff"></script> -->

    <title>SGM Opendatacube</title>
</head>

<body>

    <div id="app" class="main-container">
        <div class="main-menu">
            <div class="container-fluid">
                <!-- Breadcrumb -->
                <nav v-if="currentPage === 'search'" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item active"  aria-current="page">Поиск</li>
                    </ol>
                </nav>
                <nav v-else-if="currentPage === 'select'" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='search'">Поиск</a></li>
                        <li class="breadcrumb-item active"  aria-current="page">Выбор</li>
                    </ol>
                </nav>
                <nav v-else-if="currentPage === 'process'" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='search'">Поиск</a></li>
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='select'">Выбор</a></li>
                        <li class="breadcrumb-item active"  aria-current="page">Обработка</li>
                    </ol>
                </nav>
                <nav v-else-if="currentPage === 'result'" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='search'">Поиск</a></li>
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='select'">Выбор</a></li>
                        <li class="breadcrumb-item"><a href="#" @click="currentPage='process'">Обработка</a></li>
                        <li class="breadcrumb-item active"  aria-current="page">Результат</li>
                    </ol>
                </nav>
                <nav v-else aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item active"  aria-current="page">Поиск</li>
                    </ol>
                </nav>
                <!-- Breadcrumb End -->
                <!-- Search Page -->
                <div v-if="currentPage === 'search'" class="container-fluid">
                    <h1>Поиск</h1>
                    <h3 class="mt-3">Временной интервал</h3>
                    <div class="row">
                        <div class="col">
                            <input type="date" v-model="dates.date1" class="form-control" id="inputDate1"
                                aria-describedby="helpInputDate1" placeholder="2012-02-10">
                            <small id="helpInputDate1" class="form-text text-muted">Начальная дата</small>
                        </div>
                        <div class="col">
                            <input type="date" v-model="dates.date2" class="form-control" id="inputDate2"
                                aria-describedby="helpInputDate2" placeholder="2012-02-10">
                            <small id="helpInputDate2" class="form-text text-muted">Конечная дата</small>
                        </div>
                    </div>
                    <h3 class="mt-3">Регион поиска</h3>
                    <div class="row">
                        <div class="col"></div>
                        <div class="col">
                            <input type="number" v-model="roi.minlat" class="form-control" id="inputLat1"
                                aria-describedby="helpInputLat1" placeholder="60">
                            <small id="helpInputLat1" class="form-text text-muted">Начальная широта</small>
                        </div>
                        <div class="col"></div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <input type="number" v-model="roi.minlon" class="form-control" id="inputLon1"
                                aria-describedby="helpInputLon1" placeholder="120">
                            <small id="helpInputLon1" class="form-text text-muted">Начальная долгота</small>
                        </div>
                        <div class="col">
                        </div>
                        <div class="col">
                            <input type="number" v-model="roi.maxlat" class="form-control" id="inputLon2"
                                aria-describedby="helpInputLon2" placeholder="120">
                            <small id="helpInputLon2" class="form-text text-muted">Конечная долгота</small>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col"></div>
                        <div class="col">
                            <input type="number" v-model="roi.minlon" class="form-control" id="inputLat2"
                                aria-describedby="helpInputLat2" placeholder="60">
                            <small id="helpInputLat2" class="form-text text-muted">Конечная широта</small>
                        </div>
                        <div class="col"></div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <button id="searchButton" v-on:click="search" type="button" class="btn btn-primary" :disabled="loading">
                                <span v-if="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Искать
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Search Page End -->
                <!-- Result Page -->
                <div v-if="currentPage == 'select'" class="container-fluid">
                    <h1>Выбор снимка</h1>
                    <h3 v-if="items.length > 0">Результаты поиска</h3>
                    <h3 v-else>Поиск результатов не дал</h3>
                    <search-item v-for="item in items" :item="item" :key="item.id" v-model="itemsToProcess" @selectevent="onSelect"></search-item>
                </div>
                <!-- Result Page End -->
                <!-- Process Page Start -->
                <div v-if="currentPage === 'process'" class="container-fluid">
                    <h1>Обработка</h1>
                    <h3>Снимок</h3>
                    <process-item :item="selectedItem" :key="selectedItem.id"></process-item>
                    <h3>Алгоритм</h3>
                    <div class="row">
                        <div class="col">
                            <select v-model="algorithm" class="form-select" id="selectAlgo" aria-describedby="helpSelectAlgo">
                                <option value="getband" selected>Получить канал</option>
                                <option value="calculateindex">Посчитать индекс</option>
                            </select>
                            <small id="helpSelectAlgo" class="form-text text-muted">Выбор алгоритма</small>
                        </div>
                    </div>
                    <div v-if="algorithm == 'getband'" class="row">
                        <div class="col">
                            <select v-model="channelSelect" class="form-select" id="selectBand" aria-describedby="helpSelectBand">
                                <option v-for="(item , index) in bandOptions" v-bind:key="index" :selected= "index == 0" :value="`B${index + 1}`">
                                    [[ item.band ]]
                                </option>
                            </select>
                            <small id="helpSelectBand" class="form-text text-muted">Выбор канала</small>
                        </div>
                    </div>
                    <div v-if="algorithm == 'calculateindex'" class="row">
                        <div class="col">
                            <select v-model="indexSelect" class="form-select" id="selectIndex" aria-describedby="helpSelectIndex">
                                <option value="RGB" selected>RGB</option>
                                <option value="NDVI">NDVI</option>
                            </select>
                            <small id="helpSelectIndex" class="form-text text-muted">Выбор индекса</small>
                        </div>
                    
                    </div>
                    <div v-if="algorithm && (channelSelect || indexSelect)" class="row">
                        <div class="col">
                            <button type="button" class="btn btn-primary" @click="process" :disabled="selectedItem.loading">
                                <span v-if="selectedItem.loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Запустить алгоритм
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Process Page End-->
                <!-- Result Page Start -->
                <div v-if="currentPage === 'result'" class="container-fluid">
                    <h1>Результат</h1>
                    <h3>Обработанный снимок</h3>
                    <result-item :item="selectedItem" :key="selectedItem.id"></result-item>
                </div>
                <!-- Result Page End -->
            </div>
        </div>
        <div id=mapid></div>
    </div>


    <!-- 
    <div id="app" class="container">
        <div class="panel">
            <div id="menu" class="menu">
                <div class="search_menu">
                    <h1>Поиск</h1>
                    <div class="input_group">
                        <label>
                            Широта:
                            <input v-model="roi.minlat" size=8>
                            <input v-model="roi.maxlat" size=8>
                        </label>
                    </div>
                    <div class="input_group">
                        <label>
                            Долгота:
                            <input v-model="roi.minlon" size=8>
                            <input v-model="roi.maxlon" size=8>
                        </label>
                    </div>
                    <div class="input_group">
                        <label>
                            Даты:
                            <input v-model="dates.date1" size=8>
                            <input v-model="dates.date2" size=8>
                        </label>
                    </div>
                    <button id="search" v-on:click="search">Искать</button>
                </div>
                
                <div class="process_menu">
                    <h1>Обработка</h1>
                    <h2>Выбрано файлов: [[ itemsToProcess.length ]]</h2>
                    <div class="input_group">
                        <label>
                            Алгоритм:
                        <select v-model="algorithm">
                            <option disabled value="">Выберете алгоритм</option>
                            <option value="rgb">Псевдоцветное изображение</option>
                            <option value="pan">Панхроматическое изображение</option>
                            <option value="ndvi">NDVI</option>
                        </select>
                        </label>
                    </div>
                    <button id="process" v-on:click="process">Обработать</button>
                </div>

            </div>
            

            <div class="items">
                <search-item v-for="item in items" :item="item" :key="item.id" v-model="itemsToProcess" @select="onSelect"></search-item>
            </div>
        </div>
        <div id="mapid">
        </div>
    </div> -->

    <script src="/static/scripts/script.js"></script>
</body>

</html>